{"version":3,"file":"Settings.js","sourceRoot":"","sources":["../../ts/components/Settings.tsx"],"names":[],"mappings":"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","sourcesContent":["import { batch, Signal, useComputed, useSignal } from '@preact/signals'\nimport { formatUnits, parseUnits } from 'ethers'\nimport { JSX } from 'preact/jsx-runtime'\nimport { MEV_RELAY_MAINNET } from '../constants.js'\nimport { AppSettings } from '../types/types.js'\nimport { Button } from './Button.js'\n\nexport const SettingsIcon = () => {\n\treturn (\n\t\t<svg\n\t\t\tclass='text-white h-8 w-8'\n\t\t\taria-hidden='true'\n\t\t\tfill='none'\n\t\t\tstroke='currentColor'\n\t\t\tstrokeWidth={1.5}\n\t\t\tviewBox='0 0 24 24'\n\t\t\txmlns='http://www.w3.org/2000/svg'\n\t\t>\n\t\t\t<path\n\t\t\t\td='M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z'\n\t\t\t\tstrokeLinecap='round'\n\t\t\t\tstrokeLinejoin='round'\n\t\t\t/>\n\t\t\t<path d='M15 12a3 3 0 11-6 0 3 3 0 016 0z' strokeLinecap='round' strokeLinejoin='round' />\n\t\t</svg>\n\t)\n}\n\nexport const SettingsModal = ({ display, appSettings }: { display: Signal<boolean>, appSettings: Signal<AppSettings> }) => {\n\tconst relayEndpointInput = useSignal({ value: appSettings.peek().relayEndpoint, valid: true })\n\tconst priorityFeeInput = useSignal({ value: formatUnits(appSettings.peek().priorityFee, 'gwei'), valid: true })\n\tconst blocksInFutureInput = useSignal({ value: appSettings.peek().blocksInFuture.toString(10), valid: true })\n\n\tconst allValidInputs = useComputed(() => relayEndpointInput.value.valid && priorityFeeInput.value.valid && blocksInFutureInput.value.valid)\n\n\tfunction validateRelayEndpointInput(value: string) {\n\t\t// https://urlregex.com/\n\t\tconst matchURL = value.match(/((([A-Za-z]{3,9}:(?:\\/\\/)?)(?:[\\-;:&=\\+\\$,\\w]+@)?[A-Za-z0-9\\.\\-]+|(?:www\\.|[\\-;:&=\\+\\$,\\w]+@)[A-Za-z0-9\\.\\-]+)((?:\\/[\\+~%\\/\\.\\w\\-_]*)?\\??(?:[\\-\\+=&;%@\\.\\w_]*)#?(?:[\\.\\!\\/\\\\\\w]*))?)/g)\n\t\trelayEndpointInput.value = { value, valid: !value || !matchURL || matchURL.length !== 1 }\n\t}\n\tfunction validatePriorityFeeInput(value: string) {\n\t\tif (!value) return priorityFeeInput.value = { value, valid: false }\n\t\ttry {\n\t\t\tparseUnits(String(Number(value)), 'gwei');\n\t\t\treturn priorityFeeInput.value = { value, valid: true }\n\t\t} catch {\n\t\t\treturn priorityFeeInput.value = { value, valid: false }\n\t\t}\n\t}\n\tfunction validateBlocksInFutureInput(value: string) {\n\t\tif (!value) return blocksInFutureInput.value = { value, valid: false }\n\t\ttry {\n\t\t\tBigInt(value)\n\t\t\treturn blocksInFutureInput.value = { value, valid: true }\n\t\t} catch {\n\t\t\treturn blocksInFutureInput.value = { value, valid: false }\n\t\t}\n\t}\n\tfunction saveSettings() {\n\t\tif (allValidInputs.value) {\n\t\t\tconst newSettings: AppSettings = { relayEndpoint: relayEndpointInput.value.value, priorityFee: parseUnits(String(Number(priorityFeeInput.value.value)), 'gwei'), blocksInFuture: BigInt(blocksInFutureInput.value.value) }\n\t\t\tappSettings.value = newSettings\n\t\t\tlocalStorage.setItem('bouquetSettings', JSON.stringify({ priorityFee: newSettings.priorityFee.toString(), blocksInFuture: newSettings.blocksInFuture.toString(), relayEndpoint: newSettings.relayEndpoint }))\n\t\t\tclose()\n\t\t}\n\t}\n\tfunction resetSettings() {\n\t\tbatch(() => {\n\t\t\tappSettings.value = { blocksInFuture: 3n, priorityFee: 10n ** 9n * 3n, relayEndpoint: MEV_RELAY_MAINNET };\n\t\t\tlocalStorage.setItem('bouquetSettings', JSON.stringify({ priorityFee: appSettings.value.priorityFee.toString(), blocksInFuture: appSettings.value.blocksInFuture.toString(), relayEndpoint: appSettings.value.relayEndpoint }))\n\t\t\trelayEndpointInput.value = { value: appSettings.peek().relayEndpoint, valid: true }\n\t\t\tpriorityFeeInput.value = { value: formatUnits(appSettings.peek().priorityFee, 'gwei'), valid: true }\n\t\t\tblocksInFutureInput.value = { value: appSettings.peek().blocksInFuture.toString(10), valid: true }\n\t\t})\n\t}\n\tfunction close() {\n\t\tbatch(() => {\n\t\t\trelayEndpointInput.value = { value: appSettings.peek().relayEndpoint, valid: true }\n\t\t\tpriorityFeeInput.value = { value: formatUnits(appSettings.peek().priorityFee, 'gwei'), valid: true }\n\t\t\tblocksInFutureInput.value = { value: appSettings.peek().blocksInFuture.toString(10), valid: true }\n\t\t\tdisplay.value = false\n\t\t})\n\t}\n\treturn display.value ? (\n\t\t<div onClick={close} className='bg-white/10 w-full h-full inset-0 fixed p-4 flex flex-col items-center md:pt-24'>\n\t\t\t<div class='h-max px-8 py-4 w-full max-w-xl flex flex-col gap-4 bg-black' onClick={(e) => e.stopPropagation()}>\n\t\t\t\t<h2 className='text-xl font-semibold'>App Settings</h2>\n\t\t\t\t<div className={`flex flex-col justify-center border h-16 outline-none px-4 focus-within:bg-white/5 bg-transparent ${!relayEndpointInput.value.valid ? 'border-red-400' : 'border-white/50 focus-within:border-white/80'}`}>\n\t\t\t\t\t<span className='text-sm text-gray-500'>MEV Relay URL</span>\n\t\t\t\t\t<input onInput={(e: JSX.TargetedEvent<HTMLInputElement>) => validateRelayEndpointInput(e.currentTarget.value)} value={relayEndpointInput.value.value} type='text' className='bg-transparent outline-none placeholder:text-gray-600' placeholder='https://' />\n\t\t\t\t</div>\n\t\t\t\t<div className={`flex flex-col justify-center border h-16 outline-none px-4 focus-within:bg-white/5 bg-transparent ${!priorityFeeInput.value.valid ? 'border-red-400' : 'border-white/50 focus-within:border-white/80'}`}>\n\t\t\t\t\t<span className='text-sm text-gray-500'>Priority Fee (GWEI)</span>\n\t\t\t\t\t<input onInput={(e: JSX.TargetedEvent<HTMLInputElement>) => validatePriorityFeeInput(e.currentTarget.value)} value={priorityFeeInput.value.value} type='number' className='bg-transparent outline-none placeholder:text-gray-600' placeholder='0.1' />\n\t\t\t\t</div>\n\t\t\t\t<div className={`flex flex-col justify-center border h-16 outline-none px-4 focus-within:bg-white/5 bg-transparent ${!blocksInFutureInput.value.valid ? 'border-red-400' : 'border-white/50 focus-within:border-white/80'}`}>\n\t\t\t\t\t<span className='text-sm text-gray-500'>Target Blocks In Future For Bundle Confirmation</span>\n\t\t\t\t\t<input onInput={(e: JSX.TargetedEvent<HTMLInputElement>) => validateBlocksInFutureInput(e.currentTarget.value)} value={blocksInFutureInput.value.value} type='number' className='bg-transparent outline-none placeholder:text-gray-600' />\n\t\t\t\t</div>\n\t\t\t\t<div className='flex gap-2'>\n\t\t\t\t\t<Button onClick={saveSettings} disabled={!allValidInputs.value} variant='primary'>Save</Button>\n\t\t\t\t\t<Button onClick={resetSettings} variant='secondary'>Reset</Button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t) : null\n}\n"]}